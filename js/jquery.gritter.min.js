(function(e){e.gritter={};e.gritter.options={position:"",class_name:"",fade_in_speed:"medium",fade_out_speed:1e3,collapse_speed:300,delay_collapse:true,time:6e3,maximum:-1,overflow_collapse_speed:250,overflow_fade_out_speed:600,overflow_delay_collapse:false};e.gritter.add=function(e){try{return t.add(e||{})}catch(n){var r="Gritter Error: "+n;typeof console!="undefined"&&console.error?console.error(r,e):alert(r)}};e.gritter.remove=function(e,n){t.removeSpecific(e,n||{})};e.gritter.removeAll=function(e){t.stop(e||{})};var t={position:"",fade_in_speed:"",fade_out_speed:"",time:"",_custom_timer:0,_item_count:0,_is_setup:0,_tpl_close:'<div class="gritter-close"></div>',_tpl_title:'<span class="gritter-title">[[title]]</span>',_tpl_item:'<div id="gritter-item-[[number]]" class="gritter-item-wrapper [[item_class]]" style="display:none"><div class="gritter-top"></div><div class="gritter-item">[[close]][[image]]<div class="[[class_name]]">[[title]]<p>[[text]]</p></div><div style="clear:both"></div></div><div class="gritter-bottom"></div></div>',_tpl_wrap:'<div id="gritter-notice-wrapper"></div>',add:function(n){if(typeof n=="string"){n={text:n}}for(i in n){if(e.trim(""+n[i]).length==0){delete n[i]}}n=e.extend({},e.gritter.options,n);if(n.text===null){throw'You must supply "text" parameter.'}if(!this._is_setup){this._runSetup()}var r=n.title,s=n.text,o=n.image||"",u=n.sticky||false,a=n.class_name,f=n.position,l=n.time||"";this._verifyWrapper();this._item_count++;var c=this._item_count,h=this._tpl_item;e(["before_open","after_open","before_close","after_close"]).each(function(r,i){t["_"+i+"_"+c]=e.isFunction(n[i])?n[i]:function(){}});this._custom_timer=0;if(l){this._custom_timer=l}var p=o!=""?'<img src="'+o+'" class="gritter-image" />':"",d=o!=""?"gritter-with-image":"gritter-without-image";if(r){r=this._str_replace("[[title]]",r,this._tpl_title)}else{r=""}h=this._str_replace(["[[title]]","[[text]]","[[close]]","[[image]]","[[number]]","[[class_name]]","[[item_class]]"],[r,s,this._tpl_close,p,this._item_count,d,a],h);if(this["_before_open_"+c]()===false){return false}e("#gritter-notice-wrapper").addClass(f).append(h);var v=e("#gritter-item-"+this._item_count).addClass("gritter-static");v.fadeIn(this.fade_in_speed,function(){t["_after_open_"+c](e(this))});if(!u){this._setFadeTimer(v,c)}e(v).bind("mouseenter mouseleave",function(n){if(n.type=="mouseenter"){if(!u){t._restoreItemIfFading(e(this),c)}}else{if(!u){t._setFadeTimer(e(this),c)}}t._hoverState(e(this),n.type)});e(v).find(".gritter-close").click(function(){t.removeSpecific(c,{},null,true)});var m=e("#gritter-notice-wrapper .gritter-static");while(n.maximum>0&&m.length>n.maximum){this.removeSpecific(null,{speed:n.overflow_fade_out_speed,collapse_speed:n.overflow_collapse_speed,delay_collapse:n.overflow_delay_collapse},m.first());m=e("#gritter-notice-wrapper .gritter-static")}return c},count:function(){return e("#gritter-notice-wrapper").children().length},_countRemoveWrapper:function(t,n,r){n.remove();this["_after_close_"+t](n,r);if(this.count()==0){e("#gritter-notice-wrapper").remove()}},_fade:function(e,n,r,i){var r=r||{},s=typeof r.fade!="undefined"?r.fade:true,o=r.speed||this.fade_out_speed,u=r.collapse_speed||this.collapse_speed,a=typeof r.delay_collapse=="undefined"?this.delay_collapse:r.delay_collapse,f=i;this["_before_close_"+n](e,f);if(i){e.unbind("mouseenter mouseleave")}e.removeClass("gritter-static");if(s){if(a){e.animate({opacity:0},o,function(){e.animate({height:0},u,function(){t._countRemoveWrapper(n,e,f)})})}else{e.animate({opacity:0,height:0},{duration:u,complete:function(){t._countRemoveWrapper(n,e,f)},queue:false})}}else{this._countRemoveWrapper(n,e)}},_hoverState:function(e,t){if(t=="mouseenter"){e.addClass("hover");e.find(".gritter-close").show()}else{e.removeClass("hover");e.find(".gritter-close").hide()}},removeSpecific:function(t,n,r,i){if(!r){if(!t){throw"removeSpecific; Either unique_id or e must be specified."}var r=e("#gritter-item-"+t)}this._fade(r,t||this._getIdFromElement(r),n||{},i)},_getIdFromElement:function(e){var t=/gritter-item-([\d]+)/.exec(e.attr("id"));return t.length>1?parseInt(t[1]):null},_restoreItemIfFading:function(e,t){clearTimeout(this["_int_id_"+t]);e.stop().css({opacity:"",height:""}).addClass("gritter-static")},_runSetup:function(){for(opt in e.gritter.options){this[opt]=e.gritter.options[opt]}this._is_setup=1},_setFadeTimer:function(e,n){var r=this._custom_timer?this._custom_timer:this.time;this["_int_id_"+n]=setTimeout(function(){t._fade(e,n)},r)},stop:function(t){var n=e.isFunction(t.before_close)?t.before_close:function(){};var r=e.isFunction(t.after_close)?t.after_close:function(){};var i=e("#gritter-notice-wrapper");n(i);i.fadeOut(function(){e(this).remove();r()})},_str_replace:function(e,t,n,r){var i=0,s=0,o="",u="",a=0,f=0,l=[].concat(e),c=[].concat(t),h=n,p=c instanceof Array,d=h instanceof Array;h=[].concat(h);if(r){this.window[r]=0}for(i=0,a=h.length;i<a;i++){if(h[i]===""){continue}for(s=0,f=l.length;s<f;s++){o=h[i]+"";u=p?c[s]!==undefined?c[s]:"":c[0];h[i]=o.split(l[s]).join(u);if(r&&h[i]!==o){this.window[r]+=(o.length-h[i].length)/l[s].length}}}return d?h:h[0]},_verifyWrapper:function(){if(e("#gritter-notice-wrapper").length==0){e("body").append(this._tpl_wrap)}}}})(jQuery)
